#!/bin/bash
# Action to run after the main and shared deployment actions.
# It can be useful to enable specific modules for instance.

case $COMBAWA_BUILD_ENV in
  dev)
    # Update translations.
    $DRUSH locale:check
    $DRUSH locale:update

    # Example post install task running only on dev environments.
    # $DRUSH en MYPROJECT_NAME_content_install
    # $DRUSH pm-uninstall better_normalizers serialization hal default_content MYPROJECT_NAME_content_install

    # Rebuild search indexes.
    # $DRUSH sapi-r
    # $DRUSH sapi-i

    # Rebuild permissions
    # $DRUSH php-eval 'node_access_rebuild();'

    # Connect.
    $DRUSH uli
    ;;
  testing)
    # Update translations.
    $DRUSH locale:check
    $DRUSH locale:update

    # Rebuild search indexes.
    # $DRUSH sapi-r
    # $DRUSH sapi-i

    # Rebuild permissions
    # $DRUSH php-eval 'node_access_rebuild();'
    ;;
  prod)
    # Update translations.
    $DRUSH locale:check
    $DRUSH locale:update

    # Rebuild permissions
    # $DRUSH php-eval 'node_access_rebuild();'
    ;;
  *)
    notify_fatal "Unknown environment: $COMBAWA_BUILD_ENV. Please check your name."
esac

